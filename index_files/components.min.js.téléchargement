fg.base.namespace("fg.components");fg.components.autocomplete=function(window,$){var $autocomplete=$(".js-autocomplete");var site,for_,service,type,src;site=for_=service=type="";function init(){function __construct(){initAutocomplete()}function initAutocomplete(){$autocomplete.on("focus",function(){var $input=$(this);var appendTo;getType($input);src=Const.HOST+"ajax/autocomplete/?";if($input.parent().hasClass("js-search-input"))appendTo=".js-search-input";else appendTo="";$input.autocomplete({source:src+site+for_+service+type,minLength:3,appendTo:appendTo,delay:500,focus:function(event,ui){$input.val(ui.item.label);return false},select:function(event,ui){event.preventDefault();event.stopPropagation();$input.val(ui.item.label).blur();if(typeof ui.item.value!=="undefined"&&ui.item.value!==""&&typeof ui.item.label!=="undefined"&&ui.item.label!==ui.item.value){return $(location).attr({href:ui.item.value})}else{if(typeof $input.data("field")!=="undefined")$("#"+$input.data("field")).val(ui.item.id);return false}}})}).closest("form").on("submit",function(){$(this).find(".js-autocomplete").first().autocomplete("destroy")})}function getType($input){if(typeof $input.data("for")!=="undefined"){if(typeof $input.data("site")==="undefined"){site="&site="+$input.data("for")}else{if(typeof $input.data("site")!=="undefined")site="&site="+$input.data("site");for_="&for="+$input.data("for")}}else{if(typeof $input.data("site")!=="undefined")site="&site="+$input.data("site")}if(typeof $input.data("service")!=="undefined")service="&service="+$input.data("service");if(typeof $input.data("idtype")!=="undefined")type="&type="+$input.data("idtype")}__construct()}return{init:init}}(window,jQuery);fg.base.namespace("fg.components");fg.components.carousel=function(window,$){function init(){var that=this;function __construct(){$(".js-carousel").slick({centerMode:true,infinite:true,lazyLoad:"ondemand",mobileFirst:true,nextArrow:".js-carousel-next",prevArrow:".js-carousel-prev",slidesToShow:3,speed:300,variableWidth:true});return that}__construct()}return{init:init}}(window,jQuery);fg.base.namespace("fg.components");fg.components.company=function(window,$){var searchTerm;var situation;var type;var typeCompany;var url;var exactMatch=false;var initiatedSelection=true;var inputs={"-1":["soc_lieu","soc_pays","soc_adresse","soc_cp","soc_ville","etabl_pays","etabl_adresse","etabl_cp","etabl_ville"],0:["nom_etabl","etabl_internet","etabl_pays","etabl_adresse","etabl_cp","etabl_ville"],1:["soc_societe","soc_secteur","soc_internet","soc_secteur","soc_lieu","soc_pays","soc_adresse","soc_cp","soc_ville","soc_taille"],2:["soc_societe","soc_internet","soc_pays","soc_adresse","soc_cp","soc_ville"],3:["soc_societe","soc_internet","soc_pays","soc_adresse","soc_cp","soc_ville"]};function init(situation,type){situation=situation;type=type;if(situation==2){url="/ajax/getListSchools/";typeCompany=0}else{url="/ajax/getListCompanies/";typeCompany=$("#register_soc_type_activite").val()}$(".adress-list").on("click.chose","#adressResults tbody tr",function(e){if($(e.target).not("input"))$(this).find("[type=radio]").attr("checked","checked");$(".new-societe:visible").fadeOut("medium",function(){$(this).find(".js-form-group:visible").hide()})}).on("click.chose","#adressResults tfoot a, #adressResults tfoot [type=radio]",function(e){if($(this).is("a"))e.preventDefault();$(".adress-list:visible").find(".new-societe").find("p").hide().end().find(".js-form-group").each(function(i,e){$(e).find("input").val("").end().find("select :selected").removeAttr("selected");if(0<=$.inArray($(e).data("input"),inputs[-1]))$(e).show();else $(e).hide()}).end().show().end().fadeIn()});getListCompanies(situation,type,url,typeCompany)}function update(situation,type){situation=situation;type=type;$(".adress-list").fadeOut();$("[name=societe_id_marque]").empty();$("#register_societe").empty();if(situation==2){url="/ajax/getListSchools/";typeCompany=0}else{url="/ajax/getListCompanies/";typeCompany=$("#register_soc_type_activite").val()}initiatedSelection=false;getListCompanies(situation,type,url,typeCompany)}function getListCompanies(situation,type,url,typeCompany){$(".js-select2-company").select2({minimumInputLength:1,ajax:{url:url,dataType:"json",quietMillis:250,data:function(term,page){searchTerm=$.trim(term);return{searchTerm:term.toLowerCase(),limit:100,typeCompany:typeCompany}},results:function(response,page){if(response!==false&&typeof response.data!=="undefined"){var exactMatch=false;$.each(response.data,function(index,company){if(company.nom.toLowerCase()===searchTerm.toLowerCase()&&!exactMatch)exactMatch=true});if(exactMatch===false){response.data.unshift({nom:searchTerm.toUpperCase(),id:0});return{results:response.data}}else{if(response!==false&&typeof response.data!=="undefined"){return{results:response.data}}else{response.data.unshift({nom:searchTerm.toUpperCase(),id:0});return{results:response.data}}}}},cache:true},initSelection:function(element,callback){var name=$(element).val();searchTerm=$(element).val();if(name!==""&&initiatedSelection){name=name.toLowerCase().split(" ").join("+");$.ajax(url+"?searchTerm="+name+"&limit=100&typeCompany="+typeCompany,{dataType:"json"}).done(function(data){$.each(data.data,function(index,company){if(company.nom.toLowerCase()===searchTerm.toLowerCase()&&!exactMatch){exactMatch=true;callback(data.data[index]);if(data.data[index].id==0)showNewCompanyForm(data.data[index],situation,type);else showAdresses(data.data[index],situation);$(".js-select2-company:visible").next().val(data.data[index].id)}})})}},formatResult:companyFormatResult,formatSelection:companyFormatSelection,dropdownCssClass:"select__dropdown",escapeMarkup:function(m){return m}});$(".js-select2-company").on("select2-selecting",function(company){if(company.choice.id==0)showNewCompanyForm(company.choice,situation,type);else showAdresses(company.choice,situation)});$(".js-select2-company").on("select2-focus",function(e){$(this).removeClass("inputTextWarning");$(this).closest(".js-form-group").find(".tip-error").remove()})}function companyFormatResult(company){var markup;markup="<div "+(typeof company.marque!=="undefined"?'data-id-company="'+company.id_societe+'" ':"")+(typeof company.marque!=="undefined"?'data-id-brand="'+company.id+'" ':"")+(typeof company.id!=="undefined"?'data-id="'+company.id+'"':"")+">"+(typeof company.marque!=="undefined"?"Marque : "+company.marque:"");if(company.nb_adresse!==undefined&&company.nb_inscrits!==undefined){markup+=company.nom+" ("+company.nb_adresse+" "+FG.trad.adresses+" - "+company.nb_inscrits+" "+FG.trad.inscrits+")"}else{markup+=company.nom.toUpperCase()+" ("+FG.trad.nouvelle_societe+")"}markup+=typeof company.marque!=="undefined"?" "+company.nom:"";markup+="</div>";return markup}function companyFormatSelection(company){return company.nom}function showAdresses(company,situation){var data={};data.type=situation;if(company.id!=="undefined")data.id=company.id;var $adresses=$("#adresses_"+situation);$.getJSON("/ajax/getInfoCompanySchool/",data,function(response){if(typeof response.info!=="undefined"&&typeof response.adresse!=="undefined"){var adressList=tmpl("tmpl_adressList",response);if(typeof $("#adressResults")!=="undefined"){$adresses.find(".new-societe:visible").hide().find("input").val("");$("#adressResults").fadeOut(function(){$(this).remove()})}$adresses.prepend($(adressList).show()).find("#adressResults").find("tbody input").first().attr("checked",true).end().end().removeClass("hidden").end().fadeIn()}})}function showNewCompanyForm(company,situation,typeCompany){if($("#adressResults").length){$("#adressResults").fadeOut(function(){$(this).remove()})}$("#adresses_"+situation).find("p").hide().filter(".type_"+typeCompany).show().end().end().find(".js-from-group").each(function(i,e){if($.inArray($(e).data("input"),inputs[typeCompany])>=0){$(e).show()}else{$(e).hide().val("")}}).end().find(".new-societe").show().end().fadeIn(function(){$(this).find('[name="soc_societe"], [name="nom_etabl"]').val(company.nom)})}return{init:init,update:update}}(window,jQuery);fg.base.namespace("fg.components");fg.components.eventZoom=function(window,$){var ajaxRequest;function init(){function __construct(){initEventZoom()}function initEventZoom(){var $zoom=$(".js-zoom");if($(window).innerWidth()>999)$zoom.off("click",getZoom).on("click",getZoom);else $zoom.unbind("click");$(window).on("resize",function(){if($(window).innerWidth()>999)$zoom.off("click",getZoom).on("click",getZoom);else $zoom.unbind("click")})}function getZoom(){var $this=$(this);var xhrUrl=$this.data("xhr-url");var imageUrl=$this.data("image-url");if($.typeOf(ajaxRequest)===false){ajaxRequest=true;fg.utils.loader.global();$.ajax({data:{url_media:imageUrl},dataType:"JSON",type:"POST",url:xhrUrl,success:getZoomSuccess,complete:function(){ajaxRequest=null},error:function(){fg.utils.loader.hide()}})}}function getZoomSuccess(imageSrc){if(imageSrc&&typeof imageSrc!=="undefined")handleContainer(imageSrc);else fg.utils.loader.hide()}function handleContainer(imageSrc){var $container=$("<div />").attr("id","fg-zoom").append('<div class="fg-zoom__layer"></div>').appendTo($("body"));handleImage($container,imageSrc);$container.on("touchmove",false)}function handleImage($container,imageSrc){var $image=$("<img />").attr("src",imageSrc).css({width:$(window).width(),opacity:0}).appendTo($container);$image.bind("contextmenu",function(e){e.preventDefault();hideZoom($container)}).bind("error",function(){$(this).removeAttr("style");$container.remove();fg.utils.loader.hide()}).one("load",function(e){var self=this;var $self=$(this);positionLargeZoom(self,$container,e);$container.append($("<span />").addClass("fg-zoom__close").click(function(){hideZoom($container)}));fg.utils.loader.hide();$self.css({height:self.naturalHeight*(self.width/self.naturalWidth),opacity:1}).on("mousemove touchmove",function(e){if(this.height>$(window).height()){positionLargeZoom(this,$container,e)}});$(window).bind("resize.zoom",function(){var $this=$(this);var windowWidth=$this.width();var windowHeight=$this.height();$image.css({width:windowWidth,height:self.naturalHeight*(windowWidth/self.naturalWidth)});$self.css("top",0)});$("body").addClass("fg-overlay").on("keydown.typing",function(e){e.preventDefault();e.stopPropagation();if($.inArray(e.which,[8,27])>-1){hideZoom($container);return false}})}).each(function(){if(typeof ga=="function")ga("send","event","gallery","click","Affichage photo HD");if(this.complete)$(this).load()});$container.on("click.hideZoom",function(){hideZoom($(this))})}function positionLargeZoom($image,$container,event){var offset=$container.offset();var outerHeight=$container.outerHeight();var yRatio=($image.height-outerHeight)/outerHeight;var top;if(event.type=="mousemove")top=event.pageY-offset.top;else if(event.type=="touchmove"){top=event.originalEvent.touches[0].pageY-offset.top}else{top=null}if(top>outerHeight){top=outerHeight}else if(top<0){top=0}$image.style.top=top*-yRatio+"px"}function hideZoom($container){$container.hide().remove();$("body").removeClass("fg-overlay").off("keydown.typing");$(window).unbind("resize.zoom");$(document).bind("touchmove")}__construct()}return{init:init}}(window,jQuery);fg.base.namespace("fg.components");fg.components.favorite=function(window,$){function init(){bindFavorite()}function bindFavorite(){var $button=$(".js-handle-favorite");$button.off("click",handleFavorite).on("click",handleFavorite)}function handleFavorite(){var $this=$(this);var $jobItem=$this.closest(".js-job-item");var jobId=$this.data("job-id");var isFavorite=$this.data("job-favorite");fg.utils.loader.global();if(isFavorite)bindRemoveFavorite($this,jobId);else bindAddFavorite($this,jobId)}function bindAddFavorite($this,jobId){var xhrURL=$this.data("job-favorite-addition-url");$.ajax({url:xhrURL,type:"POST",data:{id_annonce:jobId},dataType:"json",success:function(response){if(!FG.Utils.Tools.AJAXReturn(response))return;fg.utils.loader.hide();if(response.result){ga("send","event","Annonces","Favoris","Ajout favori")}FG.Utils.Dialog.open({ui:{title:FG.trad.ajouter_aux_favoris,dialogClass:"dialog"},html:FG.trad.ajout_favoris_reussi});$this.addClass("is-active");$this.data("job-favorite",true)},error:function(){fg.utils.loader.hide();FG.Utils.Dialog.open({ui:{title:FG.trad.ajouter_aux_favoris,dialogClass:"dialog-error"},html:FG.trad.erreur_survenue})}})}function bindRemoveFavorite($this,jobId){var xhrURL=$this.data("job-favorite-deletion-url");if(confirm(FG.trad.confirm_suppr_favori)){$.ajax({url:xhrURL,type:"POST",data:{id_annonce:jobId},dataType:"json",success:function(response){if(!FG.Utils.Tools.AJAXReturn(response))return;fg.utils.loader.hide();FG.Utils.Dialog.open({ui:{title:FG.trad.retirer_des_favoris,dialogClass:"dialog"},html:FG.trad.msg_suppr_favori});$this.removeClass("is-active");$this.data("job-favorite",false)},error:function(){fg.utils.loader.hide();FG.Utils.Dialog.open({ui:{title:FG.trad.retirer_des_favoris,dialogClass:"dialog-error"},html:FG.trad.erreur_survenue})}})}}return{init:init}}(window,jQuery);fg.base.observer.subscribe("/start",fg.components.favorite.init);fg.base.namespace("fg.components");fg.components.filter=function(window,$){function init(){var $form=$(".js-filters-form");var $listing=$(".js-listing");var $checkboxes=$form.find('[type="checkbox"], [type="radio"]');var $checkAllCheckboxes=$form.find(".js-filter-checkAll");var $submit=$(".js-filters-submit");var $scroll=$(".js-scrollbar");var timeout;var that=this;var step=1;function __construct(){bindPagination();allCheckboxes();bindMoreCriteria();collapseFilters();expandTags();historyState();removeAllCheckboxes();removeCheckbox();resetForm();triggerAutocomplete();updateSize();if($(window).innerWidth()<1e3){triggerHandleListing();if(!$form.hasClass("is-open"))$form.find(".is-collapsed").hide()}else{if(!$form.hasClass("is-open"))$form.find(".is-collapsed:not(.is--hidden)").show();if($form.hasClass("is-slideshow"))triggerHandleListing();else handleListing()}$(window).on("resize",function(){if($(window).innerWidth()<1e3){triggerHandleListing();if(!$form.hasClass("is-open"))$form.find(".is-collapsed").hide()}else{if(!$form.hasClass("is-open"))$form.find(".is-collapsed:not(.is--hidden)").show();if($form.hasClass("is-slideshow"))triggerHandleListing();else handleListing()}expandTags()});return that}function bindPagination(){var $button=$(".js-filters-pagination");$button.off("click",handlePagination).on("click",handlePagination)}function handlePagination(){var $this=$(this);var page=$this.data("page");getListing($form,page)}function updateSize(){$scroll.on("hidden.bs.collapse",function(e){fg.components.scrollbar.updateScrollbar($(this))}).on("shown.bs.collapse",function(e){fg.components.scrollbar.updateScrollbar($(this))})}function allCheckboxes(){$checkAllCheckboxes.on("change",function(){var $this=$(this);var $filter=$this.closest(".js-filter-checkboxes");var $checkAllCheckboxes=$filter.find(".js-filter-checkbox");$checkAllCheckboxes.prop("checked",$this.prop("checked"))})}function collapseFilters(){$(".js-filters-collapse").off("click").on("click",function(e){e.preventDefault();e.stopPropagation();var $this=$(this);var $form=$this.closest(".js-filters-form");$form.toggleClass("is-open");if(!$form.hasClass("is-open"))$form.find(".is-collapsed").hide()})}function bindMoreCriteria(){var $moreCriteria=$(".js-filters-more-criteria");$moreCriteria.off("click",handleMoreCriteria).on("click",handleMoreCriteria)}function handleMoreCriteria(){var $this=$(this);var $hiddenFilters=$form.find(".js-filter.is-hidden");$this.toggleClass("is-active");$hiddenFilters.toggle()}function expandTags(){var $filterTags=$(".js-filter-tags");var $expandAll=$(".js-filters-expandAll");var $removeAll=$(".js-filters-removeAll");if($filterTags.length){var height=$filterTags.height();var scrollHeight=$filterTags[0].scrollHeight;if(height<scrollHeight){$removeAll.hide();$expandAll.show()}else{$removeAll.show();$expandAll.hide()}$expandAll.on("click",function(){$filterTags.css({maxHeight:scrollHeight});$removeAll.show();$expandAll.hide()})}}function historyState(){if($form.length){window.onpopstate=function(e){if(e.state){var historyState=history.state;if(typeof historyState==="undefined"||historyState!==step){location.reload()}}}}}function resetForm(){$(".js-filters-reset").off("click").on("click",function(e){e.preventDefault();e.stopPropagation();var $this=$(this);var $form=$this.closest(".js-filters-form");$form.find('[type="checkbox"]').prop("checked",false);$form.find('[type="text"]').val("");if(typeof timeout!=="undefined")clearTimeout(timeout);getListing($form)})}function removeCheckbox(){$(".js-listing").off("click").on("click",".js-filter-remove",function(){var $this=$(this);var $filter=$this.closest(".js-filter-tag");var filterTag=$filter.data("filter-tag");var name=filterTag.split("_")[0];var id=filterTag.split("_")[1];var $checkbox=$form.find('[type="checkbox"][id="'+filterTag+'"]');var $allCheckboxes=$form.find('[type="checkbox"][name="'+name+'[]"]');if(id=="-2"){$allCheckboxes.trigger("click")}else{$checkbox.trigger("click")}$filter.fadeOut()})}function removeAllCheckboxes(){$(".js-listing").on("click",".js-filters-removeAll",function(){var $this=$(this);var $filter=$this.closest(".js-filter-container").find(".js-filter-tags");var $filterTags=$filter.children();$.each($filterTags,function(index,value){var $filter=$(value);var filterTag=$filter.data("filter-tag");var $checkbox=$form.find('[type="checkbox"][id="'+filterTag+'"]');$checkbox.trigger("click");$filter.fadeOut()})})}function propCheckboxes($filter,id){var $allFilterCheckboxes=$filter.find(".js-filter-checkAll");var $filterCheckboxes=$filter.find(".js-filter-checkbox");var $filterCheckboxesChecked=$filter.find(".js-filter-checkbox:checked");if(typeof id!="undefined"&&id=="-1")$allFilterCheckboxes.prop("checked",$allFilterCheckboxes.prop("checked"));if($filterCheckboxesChecked.length==$filterCheckboxes.length)$allFilterCheckboxes.prop("checked",true);else $allFilterCheckboxes.prop("checked",false)}function triggerAutocomplete(){var $autocomplete=$(".js-filter-autocomplete");$autocomplete.on("blur",function(){$form.find('[name="hidden"]').trigger("change")}).on("keyup",function(){if($(this).val()==="")$form.find('[name="hidden"]').trigger("change")}).on("focus",function(){if(typeof timeout!=="undefined")clearTimeout(timeout);if(typeof ajaxRequest!=="undefined")ajaxRequest.abort()})}function triggerHandleListing(){$checkboxes.on("change",function(){var $this=$(this);var $filter=$this.closest(".js-filter-checkboxes");var id=$this.data("id");propCheckboxes($filter,id)});$submit.on("click",function(e){e.preventDefault();e.stopPropagation();if(typeof timeout!=="undefined")clearTimeout(timeout);if($form.hasClass("is-slideshow"))$(".js-cv-slideshow-backdrop").delay(600).fadeOut(250),$form.closest(".is-open").removeClass("is-open");getListing($form)})}function handleListing(){$checkboxes.on("change",function(){var $this=$(this);var $filter=$this.closest(".js-filter-checkboxes");var id=$this.data("id");propCheckboxes($filter,id);if(typeof timeout!=="undefined")clearTimeout(timeout);if($(window).innerWidth()>999)getListing($form)})}function getListing($form,page){var type=typeof $form.data("method")!=="undefined"?$form.data("method"):"GET";timeout=setTimeout(function(){var requestURL=$form.data("xhr-url");var hash=$form.attr("action");fg.utils.loader.local($listing);if(type=="POST"){var data=$form.serializeArray();if(typeof page!=="undefined"){data.push({name:"page",value:page})}if($form.hasClass("is-slideshow")){data.push({name:"typeView",value:"view.slideshow"})}$.ajax({data:data,dataType:"JSON",type:type,url:requestURL,success:getContentSuccess,complete:completeCallback,error:function(jqXHR,textStatus,errorThrown){}})}else{$.ajax({cache:true,url:requestURL,type:type,dataType:"JSONP",jsonp:false,jsonpCallback:"getContentSuccess",success:getContentSuccess,complete:completeCallback,beforeSend:function(jqXHR){var formData=$form.serialize();this.url+="?"+formData;hash+="?"+formData},error:function(jqXHR,textStatus,errorThrown){}})}function completeCallback(){step++;history.pushState({step:step},null,hash);if(typeof _gaq!=="undefined"){var tmp=hash.split("/");tmp=tmp.slice(3);var requestURI="/"+tmp.join("/");_gaq.push(["_trackPageview",requestURI])}fg.utils.loader.hide($listing);setTimeout(function(){bindPagination();expandTags();historyState();removeCheckbox();removeAllCheckboxes();fg.components.fitText.init();fg.components.scrollbar.updateScrollbar($(".js-scrollbar"))},500)}},1500)}function getContentSuccess(response){var r=new fg.base.xhr.validate(response);var data=r.getData();var html=data.html;if(typeof timeout!=="undefined")clearTimeout(timeout);$listing.animate({opacity:0},400,function(){$(this).html(html).animate({opacity:1},400)});if(data.relatedUrl)fg.components.related.refreshRelatedContent(data.relatedUrl);if(data.facets)handleFacets(data.facets);if(data.show_keywords)handleKeywords(data.show_keywords);else handleKeywords(data.show_keywords);if(data.show_fashiondesigner)handleFashionDesigner(data.show_fashiondesigner);else handleFashionDesigner(data.show_fashiondesigner);$listing.trigger("contentLoaded")}function handleKeywords(keywords){var $keywords=$('.js-filter-fieldset[data-option="keywords"]');if(keywords)$keywords.removeClass("is--hidden");else $keywords.addClass("is--hidden")}function handleFashionDesigner(fashiondesigner){var $fashionDesigner=$('.js-filter-fieldset[data-option="fashiondesigner"]');if(fashiondesigner)$fashionDesigner.removeClass("is--hidden");else $fashionDesigner.addClass("is--hidden")}function handleFacets(facets){var isHidden;if($.isEmptyObject(facets)){$(".js-filter-count").text("0")}else{$.each(facets,function(facet,values){var $id=facet=="sectors"?"idSector":"id";var $option=$form.find('.js-filter-fieldset[data-option="'+facet+'"]');isHidden=true;if(typeof values.count!="undefined"&&values.count<1)$option.addClass("is--hidden");else $option.removeClass("is--hidden");if(typeof values.items!="undefined")values=values.items;var parentTab=[];$.each(values,function(key,value){var id=value[$id];if(typeof id=="undefined"){id=value[facet=="sectors"?"id":"idSector"]}var name=facet+"_"+id;var $label=$form.find('label[for="'+name+'"]');if($label.length<1)return;var $filterCount=$label.find(".js-filter-count");if($filterCount.length==1){$filterCount.text(value.count);parentTab=handleParentCollapse($label,parentTab,value.count)}if(typeof value.active!="undefined"||value.count>0||id=="-2"){$label.parent().removeClass("is--hidden");isHidden=false}else{$label.parent().addClass("is--hidden")}if(!$.isEmptyObject(value.children)){var childList=value.children;var namePrefix=facet}else if(!$.isEmptyObject(value.subItems)){var childList=value.subItems;var namePrefix=value.subItemsType}if(typeof childList!="undefined"){$.each(childList,function(id,child){var name=namePrefix+"_"+child.id;var $label=$form.find('label[for="'+name+'"]');if($label.length<1)return;$label.find(".js-filter-count").text(child.count);if(typeof value.active!="undefined"||child.count>0){$label.parent().removeClass("is--hidden");isHidden=false}else{$label.parent().addClass("is--hidden")}})}});var $filter=$('.js-filter[data-type="'+facet+'"]');if($filter.length>0){if($filter.find('input[type="checkbox"]:checked').length<=0&&isHidden===true)$filter.addClass("is--hidden");else $filter.removeClass("is--hidden")}})}}function handleParentCollapse($label,parentTab,count){var $parent=$label.closest(':has(.js-filter-checkAll):has([data-toggle="collapse"])');var parentId=$parent.find(".js-filter-checkAll").attr("id");var $collapseButton=$parent.find('[data-toggle="collapse"]');var $collapse=$parent.find(".filter-collapse");if(typeof parentTab[parentId]=="undefined")parentTab[parentId]=0;if($collapseButton.length==1){parentTab[parentId]+=count;if(parentTab[parentId]==0){$collapseButton.addClass("is--hidden");$collapse.removeClass("in")}else{$collapseButton.removeClass("is--hidden")}}return parentTab}__construct()}return{init:init}}(window,jQuery);fg.base.namespace("fg.components");fg.components.fitText=function(window,$){function init(){var $fitText=$(".js-fittext");$.each($fitText,function(index,value){if($(value).height()>$(value).closest("div").height()){$(value).css("font-size",$(value).css("font-size").substr(0,2)-2+"px").css("line-height",$(value).css("font-size").substr(0,2)+"px")}})}return{init:init}}(window,jQuery);fg.base.observer.subscribe("/start",fg.components.fitText.init);fg.base.namespace("fg.components");fg.components.modal=function(window,$){function init(){var that=this;function __construct(){$(".js-modal").one("click",function(){var $this=$(this);initModal($this)});return that}function initModal($button){var $body=$("body");var url=$button.data("modal-href");var target=$button.data("modal-target");fg.utils.loader.global();if(typeof url!=="undefined"){$.get(url,function(data){handleModalContent($button,data)})}else if(typeof target!=="undefined"){handleStaticModal($button,$(target))}}function handleStaticModal($button,$target){$target.modal("show");fg.utils.loader.hide();bindModal($button)}function handleModalContent($button,data){$('<div class="modal hide fade">'+data+"</div>").modal("show");fg.utils.loader.hide();bindModal($button)}function bindModal($button){$("body").on("hidden.bs.modal",".modal",function(){$(this).remove()});$button.off("click").on("click",function(){initModal($button)})}__construct()}return{init:init}}(window,jQuery);fg.base.observer.subscribe("/start",fg.components.modal.init);fg.base.namespace("fg.components");fg.components.related=function(window,$){var $related=$(".js-related");var $relatedBottom=$(".js-related-bottom");var $newsletter=$(".js-newsletter");var relatedUrl=$related.data("xhr-url");var relatedBottomUrl=$relatedBottom.data("xhr-url");var newsletterUrl=$newsletter.data("xhr-url");function init(){if(typeof relatedUrl!="undefined")getRelatedContent();if(typeof relatedBottomUrl!="undefined")getRelatedBottomContent();if(typeof newsletterUrl!="undefined")getNewsletterContent()}function getRelatedContent(refreshUrl){if(typeof refreshUrl!="undefined")relatedUrl=refreshUrl;$.ajax({cache:true,url:relatedUrl,type:"GET",dataType:"jsonp",jsonp:false,jsonpCallback:"getRelatedContentSuccess",success:getRelatedContentSuccess,complete:getRelatedContentComplete,error:getContentError})}function getRelatedContentSuccess(response){var r=new fg.base.xhr.validate(response);var data=r.getData().html;handleRelatedContent(data)}function handleRelatedContent(data){$related.html(data)}function refreshRelatedContent(refreshUrl){if(typeof refreshUrl!="undefined")getRelatedContent(refreshUrl)}function getRelatedContentComplete(){if($(".js-scrollbar").length||$(".js-scrollbar-x").length)bindScrollbar()}function bindScrollbar(){fg.components.scrollbar.init();if($(".js-scrollbar-x").find(".is-active"))handleScrollPosition()}function handleScrollPosition(){var $scrollbar=$(".js-related").find(".js-scrollbar-x");var $activeItem=$scrollbar.find(".is-active");var x=$scrollbar.width();var y=$activeItem.outerWidth(true);var z=$activeItem.index();$scrollbar.scrollLeft(Math.max(0,y*z-(x-y)/2))}function getRelatedBottomContent(){$.ajax({cache:true,url:relatedBottomUrl,type:"GET",dataType:"jsonp",jsonp:false,jsonpCallback:"getRelatedBottomContentSuccess",success:getRelatedBottomContentSuccess,error:getContentError})}function getRelatedBottomContentSuccess(response){var r=new fg.base.xhr.validate(response);var data=r.getData().html;handleRelatedBottomContent(data)}function handleRelatedBottomContent(data){$relatedBottom.html(data)}function getNewsletterContent(){$.ajax({cache:true,url:newsletterUrl,type:"GET",dataType:"jsonp",jsonp:false,jsonpCallback:"getNewsletterContentSuccess",success:getNewsletterContentSuccess,error:getContentError})}function getNewsletterContentSuccess(response){var r=new fg.base.xhr.validate(response);var data=r.getData().html;handleNewsletterContent(data)}function handleNewsletterContent(data){$newsletter.html(data)}function getContentError(jqXHR,textStatus,errorThrown){}return{init:init,refreshRelatedContent:refreshRelatedContent}}(window,jQuery);fg.base.observer.subscribe("/start",fg.components.related.init);fg.base.namespace("fg.components");fg.components.scrollbar=function(window,$){function init(){var resizeTimer;$(window).on("resize",function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){updateScrollbar($(".js-scrollbar-x"))},250)});function __construct(){initScrollbar();initScrollbarX()}function initScrollbar(){var $scrollbar=$(".js-scrollbar");$.each($scrollbar,function(){var $this=$(this);$this.perfectScrollbar({wheelSpeed:2,minScrollbarLength:20,suppressScrollX:true})})}function initScrollbarX(){var $scrollbar=$(".js-scrollbar-x");$.each($scrollbar,function(){var $this=$(this);$this.perfectScrollbar({wheelSpeed:2,minScrollbarLength:20,suppressScrollY:true})})}__construct()}function updateScrollbar($scrollbar){$.each($scrollbar,function(){var $this=$(this);$this.perfectScrollbar("update")})}return{init:init,updateScrollbar:updateScrollbar}}(window,jQuery);fg.base.namespace("fg.components");fg.components.share=function(window,$){var Const={BTN_SHARE:"js-share",BTN_SHARE_PRINT:"js-share-print",TYPE_FACEBOOK:"facebook",TYPE_TWITTER:"twitter",TYPE_PINTEREST:"pinterest"};function init(){function __construct(){initShare()}function initShare(){var $buttons=$("."+Const.BTN_SHARE);var $printButton=$("."+Const.BTN_SHARE_PRINT);$buttons.off("click",handleShare).on("click",handleShare);$printButton.off("click",handlePrint).on("click",handlePrint);if($printButton.length){$(document).on("keydown",function(e){if((e.ctrlKey||e.metaKey)&&e.keyCode==80){$(".js-look-item.is-active").find($printButton).trigger("click");return false}})}}function handlePrint(){if($("#print-iframe").length)$("#print-iframe").remove();var $this=$(this);var url=$this.data("print-url");var requestIframe=true;if(requestIframe){$("<iframe />",{src:url,id:"print-iframe",class:"is--hidden"}).appendTo("body").on("load",function(){requestIframe=false;document.getElementById("print-iframe").contentWindow.print()})}}function handleShare(){var $this=$(this);var label=$this.data("share-label");var parentLabel=$this.closest("[data-share-label]").data("share-label");var type=$this.data("share-type");var description=$this.data("share-description");var media=$this.data("share-media");var parentMedia=$this.closest("[data-share-media]").data("share-media");var title=$this.data("share-title");var url=$this.data("share-url");var parentUrl=$this.closest("[data-share-url]").data("share-url");if(!label&&parentLabel)label=parentLabel;if(!media&&parentMedia)media=parentMedia;if(!url&&parentUrl)url=parentUrl;else url=window.location.href;title=title?title:document.title;switch(type){case Const.TYPE_FACEBOOK:shareFacebook(url,description,label,media);break;case Const.TYPE_TWITTER:shareTwitter(url,label);break;case Const.TYPE_PINTEREST:sharePinterest(url,label,media);break}return false}function shareFacebook(url,description,label,media){var data={method:"share",href:url};if(description&&description.length>0)data.description=description;if(label&&label.length>0)data.title=label;if(media&&media.length>0)data.picture=media;FB.ui(data);return true}function shareTwitter(url,label,media){var twitterUrl;if(label&&label.length>140)label=label.substr(0,136)+" ...";if(!media)media="";twitterUrl="http://twitter.com/share?url="+url+"&text="+label+"&image-src="+media;window.open(twitterUrl,"Twitter","height=380, width=600, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, directories=no, status=no");return true}function sharePinterest(url,label,media){var pinterestUrl;if(!media)media="";pinterestUrl="http://pinterest.com/pin/create/link?url="+url+"&media="+media+"&description="+label
;window.open(pinterestUrl,"Pinterest","height=380, width=600, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, directories=no, status=no");return true}__construct()}return{init:init}}(window,jQuery);fg.base.namespace("fg.components");fg.components.stickit=function(window,$){var $window,$body,$targetElement,$topElement,$bottomElement,$wrapperElement;var resizeTimer;var oldTargetElementPosition;var oldWindowScroll=0;var oldTotalTopElementHeights;var options;var oldTopElementTopOffset;var defaultOptions={topOffset:0,bottomOffset:0};var initialized=false;function computePositions(){var $relevantTopElement;var referenceUpperLimit=-Infinity;var totalTopElementHeights=0;$topElement.each(function(){var $this=$(this);var topElementTopOffset=$this.offset().top;var topElementHeight=$this.height();var upperLimit=topElementTopOffset+topElementHeight;totalTopElementHeights+=topElementHeight;if(upperLimit>referenceUpperLimit){referenceUpperLimit=upperLimit;$relevantTopElement=$this}});var topElementTopOffset=$relevantTopElement.offset().top;var topElementHeight=$relevantTopElement.height();var bottomElementTopOffset=$bottomElement.offset().top;var targetElementTopOffset=$targetElement.offset().top;var targetElementHeight=$targetElement.height();var windowScroll=$window.scrollTop();var windowHeight=$window.height();windowScroll=Math.min(windowScroll,$body.height()+parseInt($body.css("padding-top"))-windowHeight);windowScroll=Math.max(windowScroll,0);var upperLimit=Math.max(topElementTopOffset+topElementHeight,windowScroll)+options.topOffset;var lowerLimit=Math.min(bottomElementTopOffset,windowScroll+windowHeight)-options.bottomOffset;var elementLowerLimit=bottomElementTopOffset-options.bottomOffset;var upperAlignement=upperLimit-windowScroll;var lowerAlignement=lowerLimit-targetElementHeight-windowScroll;var elementLowerAlignement=elementLowerLimit-targetElementHeight-windowScroll;var targetElementPosition;oldTargetElementPosition=oldTargetElementPosition||upperAlignement;targetElementPosition=oldTargetElementPosition-windowScroll+oldWindowScroll+totalTopElementHeights-oldTotalTopElementHeights;targetElementPosition=Math.max(targetElementPosition,lowerAlignement);targetElementPosition=Math.min(targetElementPosition,elementLowerAlignement);targetElementPosition=Math.min(targetElementPosition,upperAlignement);if($window.scrollTop()<=75){var topOffScreenScrollOffset=$targetElement.offset().top;targetElementPosition+=topOffScreenScrollOffset}if($window.scrollTop()+$window.height()>$body.height()+parseInt($body.css("padding-top"))&&$window.height()<$body.height()+parseInt($body.css("padding-top"))){if(Math.abs($targetElement.offset().top-(oldTargetElementPosition+$window.scrollTop()))<1){var bottomOffScreenScrollOffset=$window.scrollTop()+$window.height()-($body.height()+parseInt($body.css("padding-top")));targetElementPosition-=bottomOffScreenScrollOffset}}if($window.scrollTop()<=105){$targetElement.css({position:"static",top:""})}else{$targetElement.css({position:"fixed",top:targetElementPosition+"px"})}oldTargetElementPosition=targetElementPosition;oldWindowScroll=windowScroll;oldTotalTopElementHeights=totalTopElementHeights;oldTopElementTopOffset=topElementTopOffset}var oldWidth,oldHeight;function computeSizes(){if(!enabledStickyBehaviour)return;var width=$wrapperElement.width();if(width!=oldWidth){$targetElement.width(width);oldWidth=width}var height=$targetElement.height();if(height!=oldHeight){$wrapperElement.height(height);oldHeight=height}}var enabledStickyBehaviour=true;function disableStickyBehaviour(){if(enabledStickyBehaviour){enabledStickyBehaviour=false;$window.trigger("scroll")}}function enableStickyBehaviour(){if(!enabledStickyBehaviour){enabledStickyBehaviour=true;$window.trigger("scroll")}}function registerEvents(){$window.on("scroll resize",computePositions);$window.on("scroll resize",computeSizes);$body.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",computePositions)}function unRegisterEvent(){if(!initialized)return;$window.off("scroll resize",computePositions);$window.off("scroll resize",computeSizes);$body.off("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",computePositions);$targetElement.find(" > * ").unwrap()}function init(sOptions){if($(window).innerWidth()<1e3)enabledStickyBehaviour=false;options=$.extend(defaultOptions,sOptions);$wrapperElement=$(options.targetElement);$topElement=$(options.topElement);$bottomElement=$(options.bottomElement);$wrapperElement.wrapInner("<div></div>");$targetElement=$wrapperElement.find(">div");$body=$(document.body);$window=$(window);oldTotalTopElementHeights=0;$topElement.each(function(){var $this=$(this);var topElementHeight=$this.height();oldTotalTopElementHeights+=topElementHeight});registerEvents();computePositions();computeSizes();initialized=true;if($(window).innerWidth()<1e3){disableStickyBehaviour()}else{enableStickyBehaviour()}var flagResize=false;$(window).on("resize",function(){if($(window).innerWidth()<1e3&&flagResize===false){flagResize=true;disableStickyBehaviour()}else{flagResize=true;enableStickyBehaviour()}clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){init(options)},250)})}return{init:init,unRegisterEvent:unRegisterEvent}}(window,jQuery);fg.base.namespace("fg.components");fg.components.tooltip=function(window,$){function init(){var that=this;function __construct(){$(".js-tooltip").tooltip({html:true,container:"body"});$(".js-tooltip").on("shown.bs.tooltip",function(){$("body").addClass("tooltip--open")});$(".js-tooltip").on("hidden.bs.tooltip",function(){$("body").removeClass("tooltip--open")});return that}__construct()}return{init:init}}(window,jQuery);
//# sourceMappingURL=build/static/compiled/js/components.min.js.map