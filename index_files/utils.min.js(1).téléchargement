fg.base.namespace("fg.utils");fg.utils.AdManager=function(window,$){var settings={list:"ul",node:"li",iteration:0,report:{},intervalFn:null,timeout:null};var p;function init(params){if(!Array.isArray(params.ads)||params.ads.length<1)return;p=$.extend(true,settings,params);p.cAds=p.ads.length;p.interval-=500;build(1,function(){gotoStep(0);if(p.cAds>1){p.intervalFn=setInterval(function(){return gotoStep(null)},p.interval)}});if(p.cAds>1){p.adPager.find("li").on("mouseenter",function(){if(p.timeout!=="null"){clearTimeout(p.timeout)}var _page=$(this);var pos=_page.index();if(pos<0)return;stop();p.timeout=setTimeout(function(){return gotoStep(pos)},300)}).on("mouseleave",function(){if(p.timeout!=="null"){clearTimeout(p.timeout)}});p.adContainer.on("mouseenter",function(){return stop()})}else{p.adPager.hide()}if(Const.HOST===Const.SITES.fm){$(window).bind("unload",function(){doReport()})}}function build(count,callback){var _list=$("<"+p.list+"/>");var _node=$("<"+p.node+"/>");var _pager=$("<ul/>");var callbacks=[];var _advert;$.each(p.ads,function(i,advert){if(p.cAds>1){_pager.append($("<li />").append($("<span />").text(parseInt(i+1,10))))}_advert=_node.clone();_list.append(_advert);if(typeof count==="number"&&count<=i)return;drawAd(advert,_advert,callbacks)});callbacks.push(callback);p.adContainer.append(_list.html());if(p.cAds>1){var width=parseInt(20*p.cAds,10)+"px";p.adPager.append(_pager.html()).children().filter(":eq("+p.step+")").end().end().removeClass("hidden").animate({opacity:1},2e3)}$.each(callbacks,function(i,fn){if(typeof fn==="function")fn()})}function drawAd(advert,_container,callbacks){if(typeof advert==="undefined"||typeof advert.extension!=="string")return false;if($.inArray(advert,p.ads)<0)return false;var ext=advert.extension.toLowerCase();var timestamp="";if(typeof advert.date_modification!=="undefined"&&advert.date_modification!=0)timestamp="?"+advert.date_modification;switch(ext){case".swf":_container.append($("<div />").attr({id:"pubContent_"+advert.id}).css({width:advert.width+"px",height:advert.height+"px"}));if(advert.lien.length>0){_container.append($("<a />").addClass("blank").attr({href:advert.lien,target:"_blank"}).append($("<img />").attr("src",Const.ROOT_URL_STATIC+"/img/common/blank.gif")))}callbacks.push(function(){swfobject.embedSWF(Const.ROOT_URL_MEDIA+"/publicites/"+advert.id+".swf"+timestamp,"pubContent_"+advert.id,advert.width,advert.height,"9.0.0",null,null,{wmode:"transparent",scale:"exactfit"})});break;case".jpg":case".jpeg":case".gif":case".png":if(advert.lien.length>0){var _a=$("<a />").attr({href:advert.lien,target:"_blank"})}else{var _a=$("<a />").attr({href:"#"}).css("cursor","default")}var $img=$("<img />").on("load",function(){_container.append(_a.append($(this).fadeIn("fast")))}).attr({width:advert.width,height:advert.height});$img.attr("src",Const.ROOT_URL_MEDIA+"/publicites/"+advert.id+advert.extension+timestamp);break;default:var node=$(advert.html)[0];if(typeof node==="undefined")return false;var _node=$(node);if(advert.lien.length>0){var _a=$('<a class="blank" />').attr({href:advert.lien,target:"_blank"})}if(typeof _node==="object"&&node.nodeName.toLowerCase()==="script"){if(typeof _node.attr("src")!==false||_node.attr("src")==="")return false;$('<iframe frameBorder="0" scrolling="no" />').css({width:advert.width,height:advert.height,overflow:"hidden"}).attr({src:Const.HOST+"publicite/smartads.php?adSrc="+encodeURI(_node.attr("src"))}).appendTo(_container);if(advert.lien.length>0)_container.append(_a)}else{_container.append($("<div />").html(_node))}break}if(advert.bordure==="1")_container.children("a").addClass("bordered")}function gotoStep(step){var callbacks=[];if(typeof p.intervalFn==="number"){if(p.iteration>=2){stop();return}p.iteration++}if(typeof step!=="number"){p.step++;if(p.step>=p.cAds){p.step=0}}else{p.step=step}var width=parseInt($(".js-ads").width(),10);p.adContainer.css({left:"-"+parseInt(width*p.step,10)+"px"});p.adContainer.children().removeClass("is-active").filter(":eq("+p.step+")").addClass("is-active");var _li=p.adContainer.children("li:eq("+p.step+")");if(_li.is(":empty")){drawAd(p.ads[p.step],_li,callbacks);$.each(callbacks,function(i,fn){if(typeof fn==="function")fn()})}p.adPager.children().removeClass("is-active").filter(":eq("+p.step+")").addClass("is-active");addView();bindResize()}function stop(){if(typeof p.intervalFn!=="null"){clearInterval(p.intervalFn);p.intervalFn=null}}function addView(){if(typeof p.report[p.step]==="undefined"){p.report[p.step]={id_unique:p.ads[p.step].id_pub_calendrier,views:1}}else{p.report[p.step].views++}}function doReport(){$.ajax({type:"POST",url:Const.HOST+"pub/addView/",async:false,dataType:"JSON",data:{tabPub:p.report}})}function bindResize(){var position;$(window).on("resize",function(){position=p.adContainer.find(".is-active").position().left;p.adContainer.css({left:"-"+parseInt(position,10)+"px"})})}return{init:init}}(window,jQuery);fg.base.namespace("fg.utils");fg.utils.breakpoint=function(window,$){var Breakpoints=window.Breakpoints;var DESKTOP="desktop";var DESKTOP_LARGE="desktop-large";var MOBILE="mobile";var TABLET="tablet";var defaultOptions={names:[MOBILE,TABLET,DESKTOP,DESKTOP_LARGE],headerName:"x-media-query-breakpoint"};var options;var activeBreakpoint;var callbacks={onChange:$.Callbacks("unique stopOnFalse"),onExit:$.Callbacks("unique stopOnFalse")};var changeActiveBreakpoint=function(name){activeBreakpoint=name;callbacks.onChange.fire(activeBreakpoint)};var exitBreakpoint=function(name){callbacks.onExit.fire(name)};var initBreakpoints=function(){_.each(options.names,function(breakpointName){Breakpoints.on({name:breakpointName,matched:_.partial(changeActiveBreakpoint,breakpointName),exit:_.partial(exitBreakpoint,breakpointName)})})};var getActiveBreakpoint=function(){return activeBreakpoint};var isActive=function(breakpointName){return breakpointName===activeBreakpoint};var predicates={isMobile:_.partial(isActive,MOBILE),isTablet:_.partial(isActive,TABLET),isDesktop:_.partial(isActive,DESKTOP),isDesktopLarge:_.partial(isActive,DESKTOP_LARGE)};var init=function(opts){options=$.extend({},defaultOptions,opts);initBreakpoints()};return{init:init,callbacks:callbacks,isActive:isActive,getActive:getActiveBreakpoint,DESKTOP:DESKTOP,DESKTOP_LARGE:DESKTOP_LARGE,MOBILE:MOBILE,TABLET:TABLET}}(window,jQuery);fg.base.namespace("fg.utils");fg.utils.loader=function(window,$){var $container;function global(){$container=$("body");return show($container)}function local($container){return show($container)}function show($container){$container.addClass("wrapper--loader").prepend('<div class="loader__mask"><span class="loader__icon"></span></div>')}function hide($container){if(typeof $container==="undefined")$container=$("body");$container.removeClass("wrapper--loader");$(".loader__mask").remove()}return{global:global,local:local,hide:hide}}(window,jQuery);fg.base.namespace("fg.utils");fg.utils.mobile=function(navigator){function isAndroid(){return navigator.userAgent.match(/Android/i)}function isBlackBerry(){return navigator.userAgent.match(/BlackBerry/i)}function isIOS(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)}function isOpera(){return navigator.userAgent.match(/Opera Mini/i)}function isWindows(){return navigator.userAgent.match(/IEMobile/i)}function isAny(){return isAndroid()||isBlackBerry()||isIOS()||isOpera()||isWindows()}return{isAndroid:isAndroid,isBlackBerry:isBlackBerry,isIOS:isIOS,isOpera:isOpera,isWindows:isWindows,isAny:isAny}}(navigator);
//# sourceMappingURL=build/static/compiled/js/utils.min.js.map